FROM frolvlad/alpine-oraclejdk8:slim
RUN apk --no-cache update && \
    apk --no-cache add python py-pip py-setuptools ca-certificates curl groff less && \
    pip --no-cache-dir install awscli && \
    rm -rf /var/cache/apk/*
RUN apk update && apk upgrade && apk add git && apk add zip && apk add bash bash-doc bash-completion openssh
ADD AppServerAgent.zip /home/appdynamics.zip
RUN unzip /home/appdynamics.zip -d /home && rm -rf /home/appdynamics.zip
RUN sed -i 's/^\(jdk.tls.disabledAlgorithms=\)\(.\)*/jdk.tls.disabledAlgorithms=SSLv3,TLSv1,DES,DESede, RC4, MD5withRSA, DH keySize < 2048/g' $JAVA_HOME/jre/lib/security/java.security
RUN sed -i '/\sEC keySize < 224/d' $JAVA_HOME/jre/lib/security/java.security
